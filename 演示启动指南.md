# 🚀 AI智能申请单系统 - 演示启动指南

## 📋 演示前准备清单

### ✅ 快速启动（推荐）
```bash
# 方式1: 双击运行
双击 "快速启动.bat"

# 方式2: 命令行运行  
python 启动前检查.py
```

### 🔍 手动检查步骤

#### 1. 环境检查
- [ ] Python 3.8+ 已安装
- [ ] 项目依赖已安装 (`pip install -r requirements.txt`)
- [ ] `.env` 文件已配置正确的API密钥

#### 2. 项目文件完整性
- [ ] `main.py` - 主服务文件
- [ ] `smart_expense_mcp.py` - MCP核心逻辑
- [ ] `services/` 目录 - AI和认证服务
- [ ] `templates/index.html` - 聊天界面

#### 3. 端口检查
- [ ] 端口8000未被占用
- [ ] 防火墙允许8000端口访问

## 🎯 演示流程

### 第一步：启动系统
```bash
# 执行快速启动
python main.py

# 确认看到以下信息：
# ✅ INFO: Uvicorn running on http://0.0.0.0:8000
# ✅ INFO: Application startup complete.
```

### 第二步：访问界面
- 🌐 打开浏览器访问: http://localhost:8000
- ✅ 确认看到"AI智能申请单助手"界面
- ✅ 右上角显示"系统运行正常"

### 第三步：演示8步闭环流程

#### 🎬 演示脚本1：创建申请单
```
您输入: "我要创建申请单"
AI响应: [蓝色背景] 显示完整的模板字段清单

您输入: "标题是北京出差，金额3000元，项目是客户调研，描述是前往北京进行重要客户拜访和市场调研"
AI响应: [绿色背景] ✅ 申请单创建成功！包含详细的闭环验证信息
```

#### 🎬 演示脚本2：查询申请单
```
您输入: "查询申请单S25000XXX"
AI响应: [绿色背景] 显示申请单的完整详情和所有字段信息
```

#### 🎬 演示脚本3：字段动态适应
```
1. 在易快报后台给"AI申请单"模板增加新字段
2. 重新输入: "我要创建申请单"
3. 验证: AI显示的字段清单包含新增字段
4. 创建申请单并验证新字段被正确处理
```

## 🎨 演示亮点说明

### 💡 技术亮点
1. **严格两阶段交互**
   - 第一阶段：AI获取并展示模板字段
   - 第二阶段：用户提供信息，AI创建申请单

2. **动态字段适应**
   - 每次都重新拉取最新模板
   - 自动适应字段增加/减少
   - 绝不使用历史缓存数据

3. **智能字段映射**
   - AI理解自然语言
   - 精确提取标题、金额、项目等信息
   - 自动生成有意义的默认值

4. **闭环验证机制**
   - 创建后自动查询验证
   - 对比用户输入vs实际保存内容
   - 确保数据完整性和一致性

### 🎯 业务价值
- **用户体验**: 自然语言交互，无需了解字段结构
- **系统适应性**: 模板变化时无需修改代码
- **数据准确性**: 多层验证确保信息正确
- **运维友好**: 完整的日志和错误处理

## 🚨 应急处理

### 常见问题及解决方案

#### 问题1：端口被占用
```bash
# 查找占用进程
netstat -ano | findstr 8000

# 终止进程
taskkill /pid [进程ID] /f
```

#### 问题2：依赖包缺失
```bash
# 重新安装依赖
pip install -r requirements.txt --force-reinstall
```

#### 问题3：API密钥错误
```bash
# 检查.env文件
cat .env

# 确认包含：
# DEEPSEEK_API_KEY=sk-xxxxx
# EK_APP_KEY=xxxxx  
# EK_APP_SECURITY=xxxxx
```

#### 问题4：AI不调用工具
```bash
# 重启服务器（代码热重载）
# 或使用明确的工具调用测试：
"使用get_template_fields获取模板信息"
"使用create_smart_expense创建申请单：标题XXX"
```

## 🎉 演示成功标志

### ✅ 验证清单
- [ ] 系统启动无错误
- [ ] 聊天界面正常加载
- [ ] "我要创建申请单" → AI显示字段清单
- [ ] 提供申请信息 → 成功创建申请单
- [ ] 查询功能正常工作
- [ ] 字段增加测试成功（如需要）

### 🏆 演示完美表现
1. **启动速度**: 10秒内完成启动
2. **响应时间**: AI响应在3秒内
3. **成功率**: 100%创建成功
4. **字段完整性**: 17个字段16个有内容
5. **验证准确性**: 输入与实际数据一致

---

## 📞 演示支持

如果演示过程中遇到任何问题：

1. **立即检查**: 运行 `python 启动前检查.py`
2. **快速重启**: 双击 `快速启动.bat`
3. **备用方案**: 使用备份系统

**祝演示成功！🎉**







